<!DOCTYPE html>
<html lang="en">

<head>
  <%- include('partials/head') %>
</head>

<body class="container">

  <header>
    <%- include('partials/header') %>
  </header>

  <main>
    <form id="reg-form">
      <label>Name</label>
      <input type="text" placeholder="first name" id="first">
      <input type="text" placeholder="last name" id="last">
      </br><label>Login</label>
      <input type="email" placeholder="me@example.com" id="email">
      <input type="text" placeholder="username" id="username">
      <input type="password" placeholder="password" id="password">
      </br><label>Address</label>
      <input type="text" placeholder="number" id="number">
      <input type="text" placeholder="street 1" id="street1">
      <input type="text" placeholder="street 2" id="street2">
      <input type="text" placeholder="town" id="town">
      <input type="text" placeholder="county" id="county">
      <input type="text" placeholder="postcode" id="postcode">
      </br><input type="submit">Submit</button>
    </form>

    <h2 id="success"></h2>

    <script>
      const form = document.getElementById('reg-form')
      form.addEventListener('submit',registerUser)

      async function registerUser(event){
        event.preventDefault()

        const first = document.getElementById('first').value
        const last = document.getElementById('last').value
        const email = document.getElementById('email').value
        const username = document.getElementById('username').value
        const password = document.getElementById('password').value
        const number = document.getElementById('number').value
        const street1 = document.getElementById('street1').value
        const street2 = document.getElementById('street2').value
        const town = document.getElementById('town').value
        const county = document.getElementById('county').value
        const postcode = document.getElementById('postcode').value

        const result = await fetch ('/register', {
          method: 'POST',
          headers: {'Content-Type':'application/json'
          },
          body: JSON.stringify({first, last, email, username, password, number, street1, street2, town, county, postcode
          })
        }).then((res) => res.json())

        if (result.status === 'ok'){
          //everything went ok 
          document.getElementById("success").innerHTML = "Congratulations. You Have now registered."
        } else {
          alter(result.error)
        }
console.log(result)      
}
    </script>

  </main>


  <%- include('partials/footer') %>